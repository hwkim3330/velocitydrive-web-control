<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VelocityDRIVE Terminal & Control</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #1a1a1a;
            color: #e0e0e0;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .header {
            background: #2d2d2d;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid #00a0e9;
        }

        .header h1 {
            font-size: 20px;
            color: #00a0e9;
        }

        .connection-panel {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .status-indicator {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: #f44336;
            transition: all 0.3s;
        }

        .status-indicator.connected {
            background: #4caf50;
            box-shadow: 0 0 10px #4caf50;
        }

        button {
            background: #00a0e9;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }

        button:hover {
            background: #0090d0;
        }

        button:disabled {
            background: #555;
            cursor: not-allowed;
        }

        .main-container {
            flex: 1;
            display: flex;
            overflow: hidden;
        }

        .left-panel {
            width: 60%;
            display: flex;
            flex-direction: column;
            border-right: 1px solid #404040;
        }

        .terminal-container {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: #0c0c0c;
        }

        #terminal {
            flex: 1;
            padding: 10px;
            overflow-y: auto;
            font-family: 'Cascadia Code', 'Courier New', monospace;
            font-size: 13px;
            line-height: 1.4;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .terminal-line {
            margin: 0;
            padding: 2px 0;
        }

        .terminal-line.boot {
            color: #888;
        }

        .terminal-line.tx {
            color: #00a0e9;
        }

        .terminal-line.rx {
            color: #4caf50;
        }

        .terminal-line.error {
            color: #f44336;
        }

        .terminal-line.info {
            color: #ffa726;
        }

        .input-container {
            display: flex;
            padding: 10px;
            background: #1a1a1a;
            border-top: 1px solid #404040;
        }

        #terminalInput {
            flex: 1;
            background: #2d2d2d;
            color: #e0e0e0;
            border: 1px solid #404040;
            padding: 8px;
            font-family: 'Cascadia Code', 'Courier New', monospace;
            font-size: 13px;
            border-radius: 4px 0 0 4px;
        }

        #terminalInput:focus {
            outline: none;
            border-color: #00a0e9;
        }

        #sendBtn {
            border-radius: 0 4px 4px 0;
            padding: 8px 20px;
        }

        .right-panel {
            width: 40%;
            display: flex;
            flex-direction: column;
            background: #2d2d2d;
        }

        .tabs {
            display: flex;
            background: #1a1a1a;
            border-bottom: 1px solid #404040;
        }

        .tab {
            padding: 10px 20px;
            cursor: pointer;
            background: transparent;
            color: #888;
            border: none;
            border-bottom: 2px solid transparent;
            transition: all 0.3s;
        }

        .tab.active {
            color: #00a0e9;
            border-bottom-color: #00a0e9;
        }

        .tab-content {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .command-group {
            margin-bottom: 20px;
        }

        .command-group h3 {
            color: #00a0e9;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .command-btn {
            display: block;
            width: 100%;
            margin-bottom: 8px;
            text-align: left;
            background: #1a1a1a;
            border: 1px solid #404040;
        }

        .command-btn:hover {
            background: #333;
            border-color: #00a0e9;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: #888;
            font-size: 12px;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 8px;
            background: #1a1a1a;
            color: #e0e0e0;
            border: 1px solid #404040;
            border-radius: 4px;
        }

        .form-group textarea {
            font-family: 'Cascadia Code', 'Courier New', monospace;
            font-size: 12px;
            min-height: 200px;
            resize: vertical;
        }

        .quick-action {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }

        .quick-action button {
            flex: 1;
            padding: 6px;
            font-size: 12px;
        }

        .hex-view {
            background: #0c0c0c;
            padding: 10px;
            border-radius: 4px;
            font-family: 'Cascadia Code', 'Courier New', monospace;
            font-size: 11px;
            color: #9cdcfe;
            margin-top: 10px;
        }

        .settings-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #404040;
        }

        .settings-row:last-child {
            border-bottom: none;
        }

        .checkbox-label {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
        }

        #statusBar {
            background: #1a1a1a;
            padding: 5px 20px;
            border-top: 1px solid #404040;
            font-size: 12px;
            color: #888;
            display: flex;
            justify-content: space-between;
        }

        /* Scrollbar styling */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #1a1a1a;
        }

        ::-webkit-scrollbar-thumb {
            background: #404040;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üñ•Ô∏è VelocityDRIVE Terminal & Control</h1>
        <div class="connection-panel">
            <span class="status-indicator" id="statusIndicator"></span>
            <span id="connectionStatus">Disconnected</span>
            <select id="baudRate">
                <option value="9600">9600</option>
                <option value="19200">19200</option>
                <option value="38400">38400</option>
                <option value="57600">57600</option>
                <option value="115200" selected>115200</option>
                <option value="230400">230400</option>
                <option value="460800">460800</option>
                <option value="921600">921600</option>
            </select>
            <button id="connectBtn">Connect</button>
            <button id="clearBtn">Clear</button>
        </div>
    </div>

    <div class="main-container">
        <div class="left-panel">
            <div class="terminal-container">
                <div id="terminal"></div>
                <div class="input-container">
                    <input type="text" id="terminalInput" placeholder="Enter command or raw data..." autofocus>
                    <button id="sendBtn">Send</button>
                </div>
            </div>
        </div>

        <div class="right-panel">
            <div class="tabs">
                <button class="tab active" data-tab="commands">Commands</button>
                <button class="tab" data-tab="config">Config</button>
                <button class="tab" data-tab="yaml">YAML</button>
                <button class="tab" data-tab="settings">Settings</button>
            </div>

            <!-- Commands Tab -->
            <div class="tab-content active" id="commands">
                <div class="command-group">
                    <h3>Quick Commands</h3>
                    <div class="quick-action">
                        <button onclick="sendCommand('p')">Ping (p)</button>
                        <button onclick="sendCommand('S')">Status (S)</button>
                        <button onclick="sendCommand('?')">Help (?)</button>
                    </div>
                </div>

                <div class="command-group">
                    <h3>System Commands</h3>
                    <button class="command-btn" onclick="sendCommand('AT+VERSION')">Get Version</button>
                    <button class="command-btn" onclick="sendCommand('AT+RESET')">Reset Device</button>
                    <button class="command-btn" onclick="sendCommand('AT+BOOTLOG')">Show Boot Log</button>
                    <button class="command-btn" onclick="sendCommand('AT+MEMINFO')">Memory Info</button>
                </div>

                <div class="command-group">
                    <h3>Network Commands</h3>
                    <button class="command-btn" onclick="sendCommand('AT+IFCONFIG')">Interface Config</button>
                    <button class="command-btn" onclick="sendCommand('AT+MACADDR')">MAC Addresses</button>
                    <button class="command-btn" onclick="sendCommand('AT+LINKSTATUS')">Link Status</button>
                    <button class="command-btn" onclick="sendCommand('AT+STATS')">Statistics</button>
                </div>

                <div class="command-group">
                    <h3>TSN Commands</h3>
                    <button class="command-btn" onclick="sendCommand('AT+CBS?')">CBS Status</button>
                    <button class="command-btn" onclick="sendCommand('AT+TAS?')">TAS Status</button>
                    <button class="command-btn" onclick="sendCommand('AT+PTP?')">PTP Status</button>
                    <button class="command-btn" onclick="sendCommand('AT+FRER?')">FRER Status</button>
                </div>

                <div class="command-group">
                    <h3>Custom Command</h3>
                    <input type="text" id="customCommand" placeholder="Enter custom command...">
                    <button style="width: 100%; margin-top: 8px;" onclick="sendCustomCommand()">Send Custom</button>
                </div>
            </div>

            <!-- Config Tab -->
            <div class="tab-content" id="config">
                <div class="command-group">
                    <h3>Port Configuration</h3>
                    <div class="form-group">
                        <label>Port Number</label>
                        <select id="portNumber">
                            <option value="0">Port 0</option>
                            <option value="1">Port 1</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Speed</label>
                        <select id="portSpeed">
                            <option value="auto">Auto</option>
                            <option value="10">10 Mbps</option>
                            <option value="100">100 Mbps</option>
                            <option value="1000">1 Gbps</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Duplex</label>
                        <select id="portDuplex">
                            <option value="auto">Auto</option>
                            <option value="half">Half</option>
                            <option value="full">Full</option>
                        </select>
                    </div>
                    <button onclick="applyPortConfig()">Apply Port Config</button>
                </div>

                <div class="command-group">
                    <h3>CBS Configuration</h3>
                    <div class="form-group">
                        <label>Traffic Class</label>
                        <select id="cbsTC">
                            <option value="2">TC2</option>
                            <option value="6">TC6</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Idle Slope (kbps)</label>
                        <input type="number" id="cbsIdleSlope" value="1500">
                    </div>
                    <div class="form-group">
                        <label>Send Slope (kbps)</label>
                        <input type="number" id="cbsSendSlope" value="-98500">
                    </div>
                    <button onclick="applyCBSConfig()">Apply CBS Config</button>
                </div>
            </div>

            <!-- YAML Tab -->
            <div class="tab-content" id="yaml">
                <div class="command-group">
                    <h3>YAML Configuration</h3>
                    <div class="form-group">
                        <textarea id="yamlInput" placeholder="Enter YAML configuration...">
# Example TSN Configuration
ports:
  - number: 0
    speed: 1000
    duplex: full
    enabled: true
  - number: 1
    speed: auto
    duplex: auto
    enabled: true

tsn:
  cbs:
    tc2:
      idle_slope: 1500
      send_slope: -98500
    tc6:
      idle_slope: 3500
      send_slope: -96500
  
  tas:
    cycle_time: 200000
    gate_control_list:
      - gate_states: 0xFF
        time_interval: 50000
      - gate_states: 0x01
        time_interval: 150000
  
  ptp:
    profile: automotive
    domain: 0
    priority1: 128
    priority2: 128

vlans:
  - id: 100
    name: Production
    ports: [0, 1]
                        </textarea>
                    </div>
                    <div class="quick-action">
                        <button onclick="validateYAML()">Validate</button>
                        <button onclick="convertYAML()">Convert to Commands</button>
                        <button onclick="applyYAML()">Apply Config</button>
                    </div>
                    <div id="yamlOutput" class="hex-view" style="display: none;"></div>
                </div>
            </div>

            <!-- Settings Tab -->
            <div class="tab-content" id="settings">
                <div class="command-group">
                    <h3>Terminal Settings</h3>
                    <div class="settings-row">
                        <label class="checkbox-label">
                            <input type="checkbox" id="autoScroll" checked>
                            <span>Auto-scroll</span>
                        </label>
                    </div>
                    <div class="settings-row">
                        <label class="checkbox-label">
                            <input type="checkbox" id="showTimestamp" checked>
                            <span>Show timestamps</span>
                        </label>
                    </div>
                    <div class="settings-row">
                        <label class="checkbox-label">
                            <input type="checkbox" id="showHex">
                            <span>Show hex values</span>
                        </label>
                    </div>
                    <div class="settings-row">
                        <label class="checkbox-label">
                            <input type="checkbox" id="echoInput" checked>
                            <span>Echo input</span>
                        </label>
                    </div>
                    <div class="settings-row">
                        <label class="checkbox-label">
                            <input type="checkbox" id="parseMUP1" checked>
                            <span>Parse MUP1 protocol</span>
                        </label>
                    </div>
                </div>

                <div class="command-group">
                    <h3>Connection Settings</h3>
                    <div class="form-group">
                        <label>Line Ending</label>
                        <select id="lineEnding">
                            <option value="none">None</option>
                            <option value="cr">CR (\r)</option>
                            <option value="lf">LF (\n)</option>
                            <option value="crlf" selected>CRLF (\r\n)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Data Bits</label>
                        <select id="dataBits">
                            <option value="7">7</option>
                            <option value="8" selected>8</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Stop Bits</label>
                        <select id="stopBits">
                            <option value="1" selected>1</option>
                            <option value="2">2</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Parity</label>
                        <select id="parity">
                            <option value="none" selected>None</option>
                            <option value="even">Even</option>
                            <option value="odd">Odd</option>
                        </select>
                    </div>
                </div>

                <div class="command-group">
                    <h3>Export/Import</h3>
                    <button onclick="exportLog()">Export Terminal Log</button>
                    <button onclick="saveConfig()">Save Configuration</button>
                    <button onclick="loadConfig()">Load Configuration</button>
                </div>
            </div>
        </div>
    </div>

    <div id="statusBar">
        <span id="statusText">Ready</span>
        <span id="rxTxCounter">RX: 0 | TX: 0</span>
    </div>

    <script src="js/terminal.js"></script>
</body>
</html>